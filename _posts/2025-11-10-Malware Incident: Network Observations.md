---
title: 1_ Network Observations
author: Mouna
date: 2025-11-10 11:00:00 +0800
categories: [1 Project-- Malware Incident Post-Mortem]
---
# Introduction
Observing the network while the system is malware-infected helps us see what interactions the malware has started: did it open any communication channels, is the traffic mainly inbound or outbound? can we say what is transferred (data, files, commands)?
You know what they say "Follow the data!", not the money, because there's no money involved here (yet!)

# Logic:
1. First we need a headcount of the interfaces we have on the system, we use one of the following:
```bash
$ ip -a
$ ip addr
$ ip link
```
2. Then, we need an inventory of active connections:
```bash
$ netstat -antp
$ ss -antp
```
3. We can also check DNS behaviour to see if any dns resolution modifications were performed:
```bash
$ cat /etc/resolv.conf
```
Lastly, and most importantly, 
4. We have to capture traffic to be analyzed using Wireshark -please see below for a wireshark cheatsheet-
```bash
$ tcpdump -i eth0 -nn -s 0 -w /tmp/capture.pcap
```
Don't forget to stop teh capture after a sufficient period of time has passed.

# Our network easter eggs
When analysing network, we search for a couple of compromise indicators, or even artifacts that could help us paint a clear picture of what the malware does. These indicators are:
- Destination IP addresses that the system communicates with repeatedly
- Beaconing behaviour
- Unusual open ports

# Traffic capture analysis
Once we have some information on the suspicious active communication channels, the packet capture file, from earlier (4) can provide more details, such as:
- Detailed analysis of each exchanged packet.
- Raw TCP payloads (exchanged data)

------- Add Wireshark diagram---------

This is a very crucial step, because a lot of malware families rely on data exfiltration -thus the need for outbound traffic-, or a backdoor for command and control -thus the need for inbound traffic-.
